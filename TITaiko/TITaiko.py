from ti_system import *
from ti_draw import *
from time import *

# Editable fields
data='18540:5:2111|20952:1|21404:1|22007:1|22058:1|22108:1|22158:0|22610:0|23213:1|23264:1|23314:0|23364:0|23816:0|24369:0|24470:1|24570:1|25022:1|25475:0|25776:1|26228:1|26681:0|26831:1|26982:0|27434:0|27887:0|28037:1|28188:0|28640:0|29093:0|29394:0|29545:5:905|30600:1|31053:1|31656:1|31706:1|31756:1|31806:0|32259:0|32862:1|32912:1|32962:0|33012:0|33465:0|34017:0|34118:1|34218:1|34671:1|35123:0|35424:1|35877:1|36329:0|36480:1|36630:0|37083:0|37535:0|37686:1|37836:1|38289:1|38741:1|39193:0|39646:0|39947:0|40022:0|40098:0|40173:0|40249:3|40550:0|40701:1|40852:0|41153:0|41304:1|41354:1|41404:1|41455:0|41756:0|41907:1|42058:0|42359:0|42510:1|42560:1|42610:0|42661:0|42962:0|43113:1|43264:0|43565:0|43666:1|43766:1|43867:0|44168:0|44319:1|44470:0|44771:0|44922:0|45073:1|45374:0|45525:1|45676:0|45977:1|46128:0|46279:1|46580:0|46731:1|46882:0|47183:1|47334:0|47485:1|47786:0|47937:1|48088:0|48389:0|48691:0|48841:1|48992:0|49294:0|49595:0|49897:0|50048:0|50198:1|50349:0|50500:0|50651:0|50726:0|50801:1|50952:0|51103:0|51254:1|51329:0|51404:1|51555:0|51706:0|51781:0|51857:0|51932:0|52007:1|52158:0|52309:0|52460:0|52610:1|52761:0|52912:0|53063:0|53138:0|53213:1|53364:0|53515:0|53666:1|53741:0|53816:1|53967:0|54118:0|54193:1|54269:0|54344:0|54419:1|54570:0|54721:1|54796:0|54872:0|54947:0|55022:1|55098:1|55173:0|55249:0|55324:1|55399:0|55475:1|55550:1|55625:0|55701:1|55776:0|55852:0|55927:1|56002:0|56078:0|56153:0|56228:1|56304:1|56379:0|56455:0|56530:1|56580:0|56630:0|56681:1|56756:0|56831:1|56882:1|56932:1|56982:1|57032:1|57083:1|57133:0|58640:0|58716:0|58791:0|58867:0|58942:0|59093:0|59243:1|59394:1|59545:2|59696:1|59771:1|59847:0|59997:1|60148:0|60223:1|60299:1|60374:1|60450:0|60525:0|60600:1|60751:0|60902:0|60977:0|61053:1|61203:0|61354:0|61429:0|61505:0|61580:0|61656:1|61806:0|61957:0|62108:0|62259:1|62409:1|62485:1|62560:0|62711:0|62862:1|63012:0|63163:0|63314:0|63389:0|63465:1|63615:1|63766:0|63841:0|63917:1|63992:0|64068:1|64218:1|64369:0|64520:0|64671:1|64821:0|64897:0|64972:0|65123:0|65274:1|65349:1|65424:0|65575:0|65726:0|65801:0|65877:1|65952:0|66027:1|66103:1|66178:0|66329:0|66480:1|66630:0|66781:0|66932:1|67007:0|67083:1|67158:1|67233:0|67384:1|67535:1|67610:0|67686:1|67836:1|67987:0|68289:1|68439:0|68590:1|68741:1|68892:0|68967:0|69042:0|69193:1|69344:1|69419:1|69495:0|69646:1|69796:0|69872:1|69947:1|70022:1|70098:0|70173:0|70249:1|70399:0|70550:0|70701:1|70776:1|70852:0|71002:0|71153:0|71228:0|71304:1|71379:1|71455:0|71605:0|71756:0|71907:1|71982:1|72058:0|72208:0|72359:0|72510:1|72661:0|72736:0|72811:0|72962:1|73037:0|73113:1|73188:1|73264:0|73414:0|73565:1|73640:0|73716:1|73867:1|74017:2|74168:0|74243:0|74319:1|74470:0|74620:0|74771:1|74847:0|74922:1|74997:1|75073:0|75223:0|75374:0|75450:0|75525:1|75600:1|75676:0|75826:0|75977:1|76053:0|76128:1|76203:1|76279:0|76429:1|76505:0|76580:0|76656:0|76731:1|76806:1|76882:0|76957:0|77032:1|77108:0|77183:1|77259:1|77334:0|77409:1|77485:1|77560:1|77635:0|77836:1|78037:1|78238:0|78439:1|78640:0|78841:1|78992:0|79068:0|79143:1|79294:0|79445:0|79595:0|79671:0|79746:1|79821:1|79897:0|80048:0|80198:0|80349:1|80424:1|80500:0|80651:0|80801:1|80877:0|80952:1|81027:1|81103:0|81254:0|81404:0|81480:0|81555:1|81706:0|81857:0|82007:0|82083:0|82158:1|82233:1|82309:0|82460:0|82610:0|82761:1|82912:0|82987:0|83063:0|83213:0|83364:1|83666:0|83816:0|83967:1|84118:0|84193:0|84269:0|84419:0|84570:1|84646:1|84721:0|84872:0|85022:0|85173:1|85324:0|85475:0|85625:0|85701:0|85776:1|85852:1|85927:0|86078:0|86228:0|86304:0|86379:1|86530:0|86681:0|86831:1|86907:0|86982:1|87058:1|87133:0|87208:0|87284:1|87585:0|87887:1|88037:1|88188:0|88339:1|88490:0|88791:1|88942:0|89017:0|89093:0|89243:0|89394:1|89545:0|89620:0|89696:1|89847:0|89922:1|90073:0|90148:1|90223:0|90299:0|90450:0|90600:1|90751:0|90902:0|91053:0|91203:1|91354:0|91429:0|91505:0|91656:0|91806:1|91882:1|91957:0|92108:0|92259:0|92409:1|92711:0|92786:0|92862:0|92937:0|93012:1|93163:1|93314:2|93465:0|93540:0|93615:1|93691:1|93766:0|93917:0|94068:1|94143:0|94218:1|94294:1|94369:0|94520:0|94671:0|94746:0|94821:1|94972:0|95123:1|95274:1|95349:0|95424:1|95575:0|95726:0|95952:0|96178:1|96329:0|96555:0|96781:1|96932:0|97158:0|97309:1|97384:0|97460:0|97535:1|98138:0|98439:1|98741:0|99042:1|99193:1|99243:1|99294:1|99344:0|99646:1|99947:0|100249:1|100399:1|100450:1|100500:0|100550:0|100852:1|101153:0|101455:1|101555:0|101656:1|101756:1|102058:1|102359:0|102661:1|102811:0|102962:1|103264:1|103565:0|103867:1|104017:0|104168:0|104470:1|104771:0|105073:1|105223:0|105374:0|105676:1|105977:0|106279:1|106580:0|106882:1|107183:0|107485:1|107786:0|107937:0|108088:1|108238:0|108389:0|108540:0|108615:0|108691:1|108841:0|108992:0|109143:1|109218:0|109294:1|109445:0|109595:0|109671:1|109746:0|109821:0|109897:1|110048:0|110198:0|110349:0|110500:1|110651:0|110801:0|110952:0|111027:0|111103:1|111254:0|111404:0|111555:1|111630:0|111706:1|111857:0|112007:1|112083:1|112158:0|112233:0|112309:1|112460:0|112610:1|112686:0|112761:0|112836:0|112912:1|112987:1|113063:0|113138:0|113213:1|113289:0|113364:1|113439:0|113515:1|113590:1|113666:0|113741:0|113816:1|113892:0|113967:0|114042:0|114118:1|114193:1|114269:0|114344:0|114419:1|114495:0|114570:1|114646:1|114721:0|114796:1|114872:0|114947:0|115022:1|115173:0|115249:0|115324:1|115475:0|115625:1|115776:0|115852:0|115927:1|116078:1|116228:0|117284:1|117434:0|117485:0|117535:0|117585:1|117635:1|117686:1|117736:0|117811:0|117887:1|117962:1|118037:0|118188:1|118226:1|118339:0|118640:1|118678:1|118942:0|119093:1|119130:1|119243:0|119545:1|119583:1|119847:0|120148:0|120299:0|120450:0|120525:1|120600:1|120676:1|120751:0|120826:1|120902:1|120977:1|121053:0|121203:1|121279:1|121354:0|121429:1|121505:1|121656:0|121731:1|121806:1|121882:1|121957:0|122259:0|122309:0|122359:0|122409:1|122485:0|122560:1|122711:0|122862:0|123012:1|123050:1|123163:0|123465:1|123502:1|123766:0|123917:1|123955:1|124068:0|124369:1|124407:1|124671:0|124721:0|124771:0|124821:0|124897:0|124972:1|125123:0|125274:0|125424:1|125462:1|125575:1|125613:1|125726:1|125764:1|125877:0|125927:0|125977:0|126027:1|126103:1|126178:0|126329:0|126404:0|126480:1|126781:0|127083:0|127133:0|127183:0|127233:1|127284:1|127334:1|127384:0|127460:0|127535:1|127610:1|127686:0|127836:1|127874:1|127987:0|128289:1|128326:1|128590:0|128741:1|128779:1|128892:0|129193:1|129231:1|129495:0|129545:0|129595:0|129646:0|129796:0|129947:0|130098:0|130173:1|130249:1|130324:1|130399:0|130475:1|130550:1|130625:1|130701:0|130852:1|130927:1|131002:0|131078:1|131153:1|131304:0|131379:1|131455:1|131530:1|131605:0|131907:0|132058:0|132208:1|132359:0|132434:0|132510:0|132661:1|132698:1|132811:0|133113:1|133151:1|133264:0|133414:0|133565:1|133603:1|133867:0|134017:1|134055:1|134168:0|134319:0|134470:1|134507:1|134771:1|134809:1|134922:0|135073:0|135223:1|135299:1|135374:0|135450:1|135525:0|136731:1|136781:1|136831:1|136882:0|136932:1|136982:1|137032:0|137108:0|137183:0|137259:0|137334:1|137485:1|137635:0|137686:0|137736:0|137786:1|137836:0|137887:0|137937:1|138012:1|138088:0|138163:0|138238:1|138389:0|138465:0|138540:1|138691:0|138841:1|138879:1|138992:1|139030:1|139143:0|139193:0|139243:0|139294:0|139445:1|139595:0|139671:0|139746:1|139897:0|140048:1|140123:0|140198:1|140274:1|140349:1|140500:1|140651:0|140726:1|140801:1|140952:0|141002:0|141053:0|141103:1|141178:0|141254:1|141329:1|141404:0|141555:0|141605:0|141656:0|141706:1|141756:1|141806:1|141857:0|141932:0|142007:0|142083:0|142158:1|142309:1|142384:0|142460:1|142535:1|142610:0|142661:0|142711:0|142761:1|142836:1|142912:0|143063:1|143213:0|143289:0|143364:1|143515:0|143666:1|143703:1|143816:1|143854:1|143967:0|144017:0|144068:0|144118:0|144269:1|144495:0|144570:1|144721:0|144796:1|144947:1|145022:0|145173:1|145324:0|145399:1|145550:1|145625:0|145701:0|145776:1|145927:0|146002:0|146078:1|146153:1|146228:0|146379:0|146429:1|146480:1|146530:0|146580:0|146630:0|146681:1|146831:0|146907:0|146982:0|147133:0|147284:1|147434:1|147510:1|147585:0|147635:0|147686:0|147736:1|147811:0|147887:1|147962:1|148037:0|148188:0|148264:1|148339:0|148490:1|148640:1|148716:1|148791:0|148841:0|148892:0|148942:0|149093:1|149243:1|149394:0|149470:0|149545:1|149696:0|149771:1|149847:1|149922:1|149997:0|150073:1|150148:1|150223:1|150299:0|150374:1|150450:1|150525:1|150600:0|150651:0|150701:0|150751:1|150826:0|150902:1|150977:1|151053:0|151203:1|151505:1|151656:0|151806:0|151957:1|151995:1|152108:0|152409:1|152447:1|152560:0|152711:0|152862:1|152899:1|153163:0|153314:1|153352:1|153465:0|153615:0|153766:1|153804:1|154068:1|154105:1|154218:0|154369:1|154407:1|154520:0|154671:1|154708:1|154821:0|155726:1|155801:1|155877:1|155952:1|156027:2|156329:1|156480:0|156781:1|156932:0|158037:1|158238:1|158439:0|158741:1|158892:0|159193:1|159344:0|160450:0|160651:1|160852:1|161153:1|161304:0|161605:1|161756:0|162862:0|163063:1|163264:0|163565:0|163716:1|164017:0|164168:1|164470:4:-24|165676:0|165977:1|166128:0|166429:1|166580:0|167686:1|167887:0|168088:0|168389:1|168540:0|168841:1|168992:0|170098:0|170299:1|170500:0|170801:1|170952:0|171254:1|171404:0|172510:0|172711:1|172912:0|173213:0|173364:1|173666:0|173816:1|174118:5:1055|175324:2|175625:0|175927:0|176228:0|176379:1|176429:1|176480:1|176530:0|176831:0|177133:0|177434:0|177585:1|177635:1|177686:0|177736:0|178037:0|178339:0|178640:0|178741:0|178841:1|178942:1|179243:0|179545:0|179847:0|180148:1|180450:0|180751:0|181053:0|181203:0|181354:1|181656:0|181957:0|182259:0|182409:0|182560:1|182862:0|183163:0|183465:0|183766:0|183917:5:904|184972:0|185123:0|185274:1|185424:0|185575:0|185726:0|185801:0|185877:1|186027:0|186178:0|186329:1|186404:0|186480:1|186630:0|186781:0|186857:0|186932:0|187007:0|187083:1|187233:0|187384:0|187535:0|187686:1|187836:0|187987:0|188138:0|188213:0|188289:1|188439:0|188590:0|188741:1|188816:0|188892:1|189042:0|189193:1|189269:1|189344:0|189419:0|189495:1|189646:0|189796:1|189872:0|189947:0|190022:0|190098:1|190173:1|190249:0|190324:0|190399:1|190475:0|190550:1|190625:0|190701:1|190776:1|190852:0|190927:0|191002:1|191078:0|191153:0|191228:0|191304:1|191379:1|191455:0|191530:0|191605:1|191656:0|191706:0|191756:1|191831:0|191907:1|191957:1|192007:1|192058:1|192108:1|192158:1|192208:0|192359:5:1055|193565:4:-25|194168:0|194243:0|194319:1|194470:1|194620:2|194771:1|194847:1|194922:0|194997:0|195073:1|195223:0|195374:1|195450:0|195525:0|195600:0|195676:1|195751:1|195826:0|195977:1|196053:0|196128:1|196203:0|196279:1|196354:1|196429:0|196580:1|196656:0|196806:1|196882:0|196957:0|197032:1|197183:1|197259:0|197334:1|197409:1|197485:0|197560:0|197635:1|197786:0|197937:1|198012:0|198088:1|198163:1|198238:0|198389:1|198465:0|198615:1|198691:0|198766:0|198841:1|198917:0|198992:1|199068:0|199143:1|199218:1|199294:0|199369:0|199445:1|199595:1|199671:1|199746:0|199821:0|199897:1|200048:0|200123:0|200198:1|200274:0|200349:1|200424:1|200500:0|200651:0|200801:1|200877:0|200952:1|201027:1|201103:0|201178:1|201254:0|201404:1|201480:0|201630:1|201706:0|201781:0|201857:1|202007:0|202083:0|202158:1|202233:1|202309:0|202384:0|202460:1|202535:0|202610:1|202686:1|202761:0|202912:1|203063:0|203213:0|203289:0|203364:1|203515:0|203666:0|203741:0|203816:0|203892:0|203967:1|204118:1|204269:1|204419:0|204495:0|204570:1|204646:0|204721:1|204872:1|205022:0|205098:0|205173:1|205324:1|205399:0|205475:1|205625:1|205701:0|205776:1|205852:1|205927:0|206002:0|206078:1|206228:1|206304:0|206455:1|206530:0|206605:0|206681:1|206831:1|206907:0|206982:1|207058:1|207133:0|207208:0|207284:1|207434:0|207585:1|207736:1|207811:0|207887:1|208037:1|208113:0|208264:1|208339:0|208414:0|208490:1|208565:0|208640:1|208716:0|208791:1|208867:1|208942:0|209017:0|209093:1|209243:1|209319:0|209394:1|209470:1|209545:0|209696:0|209771:0|209847:1|209922:1|209997:0|210073:0|210148:1|210299:0|210450:1|210525:0|210600:0|210676:0|210751:1|210902:1|210977:1|211053:1|211203:1|211354:0|211429:0|211505:1|211656:0|211806:1|211957:0|212032:0|212108:1|212259:0|212409:1|212485:1|212560:0|212635:0|212711:1|212862:5:904|213917:0|214218:3|214369:0|214445:0|214520:1|214671:1|214746:0|214821:0|214897:0|214972:1|215048:1|215123:0|215274:1|215349:0|215424:1|215500:1|215575:0|215651:1|215726:0|215877:1|215952:0|216103:1|216178:0|216254:0|216329:1|216480:1|216555:0|216630:1|216706:1|216781:0|216857:0|216932:1|217083:0|217233:1|217309:0|217384:1|217460:1|217535:0|217686:1|217761:0|217912:1|217987:0|218063:0|218138:1|218213:0|218289:1|218364:1|218439:0|218515:1|218590:0|218666:0|218741:1|218892:1|218967:1|219042:0|219118:0|219193:1|219344:0|219419:0|219495:1|219570:0|219646:1|219721:1|219796:0|219947:0|220098:1|220173:0|220249:0|220324:0|220399:1|220475:1|220550:0|220701:1|220776:0|220927:1|221002:0|221078:0|221153:1|221304:1|221379:0|221455:1|221530:1|221605:0|221681:0|221756:1|221831:0|221907:1|221982:1|222058:0|222208:1|222359:0|222510:1|222585:0|222661:1|222736:1|222811:0|222962:0|223113:1|223188:1|223264:1|223339:1|223414:1|223490:1|223565:0|223716:1|223791:1|223867:0|224017:1|224168:0|224243:0|224319:1|224394:1|224470:0|224620:1|224771:0|224922:0|224997:0|225073:1|225148:0|225223:1|225299:1|225374:0|225525:1|225600:0|225751:1|225826:0|225902:0|225977:1|226128:1|226203:1|226279:0|226429:1|226580:0|226656:0|226731:1|226806:1|226882:0|227032:1|227183:0|227334:1|227409:0|227485:1|227560:0|227635:1|227711:1|227786:0|227862:0|227937:1|228012:0|228088:1|228163:1|228238:0|228314:1|228389:0|228540:0|228691:1|228841:0|228917:0|228992:0|229143:0|229294:1|229445:0|229595:0|229746:0|229897:1|230048:0|230123:0|230198:0|230349:0|230500:1|230651:0|230801:1|230877:0|230952:0|231027:0|231103:1|231178:1|231254:0|231329:0|231404:1|231480:0|231555:1|231630:1|231706:0|231781:1|231857:0|231932:0|232007:1|232233:1|232460:0|232686:0|232761:0|232912:1|233063:1|233213:2|233364:0|233515:1|233590:1|233666:0|233741:1|233816:0|233967:0|234118:1|234269:1|234344:1|234419:0|234570:0|234721:1|234872:0|235022:0|235098:0|235173:0|235249:0|235324:1|235475:1|235625:0|235776:0|235852:0|235927:1|236002:1|236078:0|236228:0|236379:0|236530:1|236681:0|236756:0|236831:0|236982:0|237133:1|237284:0|237359:0|237434:1|237510:1|237585:0|237736:1|237887:0|238037:0|238188:0|238264:0|238339:1|238490:0|238640:0|238791:1|238867:0|238942:1|239017:1|239093:0|239243:0|239394:0|239470:0|239545:1|239696:0|239847:0|239997:0|240073:0|240148:1|240223:1|240299:0|240450:0|240600:1|240751:0|240826:0|240902:1|241053:0|241203:0|241354:1|241656:1|241957:1|242108:1|242259:0|242409:0|242560:1|242635:0|242711:0|242862:2|243012:0|243163:1|243314:0|243389:0|243465:0|243615:0|243766:1|243841:1|243917:0|244068:0|244218:0|244294:0|244369:1|244445:1|244520:0|244671:0|244821:0|244972:1|245048:1|245123:0|245274:0|245424:0|245575:1|245726:0|245801:0|245877:0|246027:0|246178:1|246329:0|246480:0|246630:0|246706:0|246781:1|246932:0|247083:1|247158:1|247233:0|247309:0|247384:1|247535:0|247686:1|247761:0|247836:1|247912:1|247987:0|248063:0|248138:1|248213:0|248289:1|248364:1|248439:0|248515:1|248590:0|248666:0|248741:1|248816:0|248892:1|248967:0|249042:1|249118:1|249193:0|249269:0|249344:1|249419:0|249495:1|249570:1|249646:0|249721:1|249796:0|249872:0|249947:1|250022:1|250098:0|250148:0|250198:0|250249:1|250324:0|250399:1|250450:1|250500:1|250550:0|250625:0|250701:1|250751:0|250801:0|250852:1|250927:1|251002:0|251078:0|251153:0|251228:0|251304:1|252510:1|252962:1|253565:1|253615:1|253666:1|253716:0|254168:0|254771:1|254821:1|254872:0|254922:0|255374:0|255927:0|256027:1|256128:1|256580:1|257032:0|257334:1|257786:1|258238:0|258389:1|258540:0|258992:0|259445:0|259595:1|259746:0|260198:0|260651:0|260952:0|262158:1|262610:1|263213:1|263264:1|263314:1|263364:0|263816:0|264419:1|264470:1|264520:0|264570:0|265022:0|265575:0|265676:1|265776:1|266228:1|266681:0|266982:1|267434:1|267887:0|268037:1|268188:0|268640:0|269093:0|269243:1|269394:1|269847:1|270299:1|270751:0|271203:0|271505:1|271806:1|272259:1|272862:1|272912:1|272962:1|273012:0|273465:0|274068:1|274118:1|274168:0|274218:0|274671:0|275223:0|275324:1|275424:1|275877:1|276329:0|276630:1|277083:1|277535:0|277686:1|277836:0|278289:0|278741:0|278892:1|279042:0|279495:0|279947:0|280399:0|280852:0|281304:0|281756:0|282208:0|282661:0|283113:0|283565:0|284017:0|284470:0|284922:0|290198:5:905'
speedMultiplier=0.5
correctionalFactor=1.0 # PC=1.0, Real Hardware=1.024
playfieldWidth=50
holdWidth=5 # Higher values mean thicker holds

# Auto-calculated fields
dataKvp=data.split('|')

startTime=ticks_ms()
notesPassed=0
while True:
  set_color(0,6,12)
  fill_rect(0,0,318,212)
  set_color(128,0,0)
  draw_circle(5+playfieldWidth/3,106,playfieldWidth/3)
  use_buffer()
  crudeTime=ticks_ms()-startTime
  currentTime=crudeTime*correctionalFactor
  removeQueue=[]
  if(get_key()=='esc' or len(dataKvp)==0):
    raise Exception()
  for obj in dataKvp:
    objData=obj.split(':')
    objType=int(objData[1])
    if (objType==0 or objType==2): # Don
      noteColor=[250,70,30]
      length=0
      size=objType*2
    elif (objType==1 or objType==3): # Kat
      noteColor=[74,189,255]
      length=0
      size=(objType-1)*2
    elif (objType==4): # Roll
      noteColor=[255,201,74]
      length=float(objData[2])
      size=0
    else: # Probably a denden
      noteColor=[255,255,255]
      length=float(objData[2])
      size=4
    set_color(noteColor[0],noteColor[1],noteColor[2])
    xPos=int(objData[0])-currentTime
    xPos*=speedMultiplier
    if(xPos+length*speedMultiplier<5+playfieldWidth/3):
      notesPassed+=1
      removeQueue.append(obj)
      continue
    if(xPos>328):
      break
    fill_circle(xPos,106,playfieldWidth/3+size)
    if(length>0):
      nxPos=xPos+length*speedMultiplier
      fill_rect(xPos,106-holdWidth/2,nxPos,holdWidth)
    
  set_color(25,128,255)
  draw_rect(-1,106-playfieldWidth/2,320,playfieldWidth)
  paint_buffer()
  for obj in removeQueue:
    dataKvp.remove(obj)
